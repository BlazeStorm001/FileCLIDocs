<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FileUtil: writeFile.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FileUtil
   &#160;<span id="projectnumber">1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">writeFile.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>header file writing to files.  
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="writeFile_8h__dep__incl.png" border="0" usemap="#writeFile_8hdep" alt=""/></div>
<map name="writeFile_8hdep" id="writeFile_8hdep">
<area shape="rect" title="header file writing to files." alt="" coords="5,5,96,32"/>
<area shape="rect" href="fileUtil_8c_source.html" title=" " alt="" coords="13,80,89,107"/>
</map>
</div>
</div>
<p><a href="writeFile_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae18ea6ea8a01745119f1a64e5ff028e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="writeFile_8h.html#ae18ea6ea8a01745119f1a64e5ff028e1">writeFile</a> (char *filename, char *location, char *offset, char *count, char *mode)</td></tr>
<tr class="memdesc:ae18ea6ea8a01745119f1a64e5ff028e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to write to a file to a specified location from an offset.  <a href="writeFile_8h.html#ae18ea6ea8a01745119f1a64e5ff028e1">More...</a><br /></td></tr>
<tr class="separator:ae18ea6ea8a01745119f1a64e5ff028e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>header file writing to files. </p>
<dl class="section author"><dt>Author</dt><dd>Namit Arora </dd></dl>

<p class="definition">Definition in file <a class="el" href="writeFile_8h_source.html">writeFile.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ae18ea6ea8a01745119f1a64e5ff028e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae18ea6ea8a01745119f1a64e5ff028e1">&#9670;&nbsp;</a></span>writeFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeFile </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to write to a file to a specified location from an offset. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>name of file to which data is to be written </td></tr>
    <tr><td class="paramname">location</td><td>specifies from where the file would be written eg beginning, end </td></tr>
    <tr><td class="paramname">offset</td><td>specifies the offset at which the file would be written to specified location </td></tr>
    <tr><td class="paramname">count</td><td>the no. of bytes to be written </td></tr>
    <tr><td class="paramname">mode</td><td>specifes how the data will be written e.g truncate, append or normal mode. In trucate mode file is truncated and data is written from beginning other args are ignored. In append mode data is written at the end, other args are ignored. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="writeFile_8c_source.html#l00011">11</a> of file <a class="el" href="writeFile_8c_source.html">writeFile.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                                                                                      {</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keywordtype">int</span> loc;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="keywordflow">if</span> (strcmp(location, <span class="stringliteral">&quot;-s&quot;</span>) == 0) {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        loc = SEEK_SET;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(location, <span class="stringliteral">&quot;-e&quot;</span>) == 0) {</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        loc = SEEK_END;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(location, <span class="stringliteral">&quot;-c&quot;</span>) == 0){</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        loc = SEEK_CUR;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        printf(<span class="stringliteral">&quot;\nEntered location is incorrect. Writing from the beginning of the file: %s\n&quot;</span>, filename);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        loc = SEEK_SET;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    }</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordtype">int</span> append;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">if</span> (strcmp(mode, <span class="stringliteral">&quot;-a&quot;</span>) == 0) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        append = O_APPEND;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(mode, <span class="stringliteral">&quot;-t&quot;</span>) == 0) {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        append = O_TRUNC;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(mode,<span class="stringliteral">&quot;-n&quot;</span>)) {        </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        append = 0;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        printf(<span class="stringliteral">&quot;\nNo mode entered or mode is incorrect. Writing data as per the offset in file %s\n&quot;</span>, filename);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        append = 0;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    }</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">long</span> st = <a class="code" href="parseUtil_8h.html#a9439165479f48aef180371cf67c3d80a">stringToLong</a>(offset);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordtype">long</span> ct = <a class="code" href="parseUtil_8h.html#a9439165479f48aef180371cf67c3d80a">stringToLong</a>(count);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">if</span>(ct &lt; 0) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        printf(<span class="stringliteral">&quot;\nInvalid no. of bytes to write...&quot;</span>);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        exit(-1);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordtype">int</span> fd = open(filename, O_WRONLY | append);  <span class="comment">// Removed O_APPEND flag</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">if</span> (fd == -1) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        perror(<span class="stringliteral">&quot;Error opening the file&quot;</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        close(fd);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        exit(-1);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    off_t seekResult = lseek(fd, st, loc);  <span class="comment">// Changed the data type of seekResult to off_t</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">if</span> (seekResult == -1) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        perror(<span class="stringliteral">&quot;Error seeking to the specified offset&quot;</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        close(fd);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        exit(-1);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordtype">char</span>* data = malloc(ct + 1);  <span class="comment">// Increased the buffer size by 1 for null terminator</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">if</span> (data == NULL) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        perror(<span class="stringliteral">&quot;Error allocating memory for data&quot;</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        close(fd);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        exit(-1);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    printf(<span class="stringliteral">&quot;\nEnter data to write: &quot;</span>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    fflush(stdout);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">if</span> (scanf(<span class="stringliteral">&quot; %s&quot;</span>, data) != 1) {  <span class="comment">// Added a space before %s to skip leading whitespaces</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        perror(<span class="stringliteral">&quot;Error reading input data&quot;</span>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        close(fd);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        free(data);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        exit(-1);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    ssize_t bytesWritten = write(fd, data, strlen(data));  <span class="comment">// Changed the data type of bytesWritten to ssize_t</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (bytesWritten == -1) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        perror(<span class="stringliteral">&quot;Error writing data to the file&quot;</span>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        close(fd);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        free(data);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        exit(-1);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    printf(<span class="stringliteral">&quot;Data written successfully to the file: %s\n&quot;</span>, filename);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    close(fd);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    free(data);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<div class="ttc" id="aparseUtil_8h_html_a9439165479f48aef180371cf67c3d80a"><div class="ttname"><a href="parseUtil_8h.html#a9439165479f48aef180371cf67c3d80a">stringToLong</a></div><div class="ttdeci">long stringToLong(char *str)</div><div class="ttdoc">for converting decimal in string to long</div><div class="ttdef"><b>Definition:</b> <a href="parseUtil_8c_source.html#l00004">parseUtil.c:4</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
